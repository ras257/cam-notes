\documentclass[../main.tex]{subfiles}
\begin{document}
\chapter{Orthogonal Curvilinear Coordinate Systems}
\section{General Curvilinear Coordinate Systems}
\begin{definition}
  A \textit{curvilinear coordinate system} in 3D is a parameterisation $(u, v, w)$ of $\R^3$.

  In other words, it is a surjective map $\vec{x}(u, v, w)$ from a subset of $\R^3$ to $\R^3$.
\end{definition}
A well known example in $\R^2$ are \textit{plane polar coordinates}.
These alternative coordinate systems are often useful when we wish to exploit a symmetry within a problem.
\begin{remark}
  Ideally $\vec{x}(u, v, w)$ would be invertible, however most coordinate systems have points where the map is not invertible.
  For example, plane polar coordinates in $\R^2$ are not invertible at the origin as $\theta$ is undefined there.
\end{remark}
\begin{definition}[Scale Factors]
  We define the \textit{scale factors} $h_u, h_v, h_w$ as:
  \label{scaleFactors}
  \[
    h_u = \abs{\pderiv{\vec{x}}{u}},\ h_v = \abs{\pderiv{\vec{x}}{v}},\ h_w = \abs{\pderiv{\vec{x}}{w}}
  \]
  and their corresponding corresponding unit vectors:
  \[
    \vec{e}_u = \frac{1}{h_u} \pderiv{\vec{x}}{u},\ \vec{e}_v = \frac{1}{h_v} \pderiv{\vec{x}}{v},\ \vec{e}_w = \frac{1}{h_w} \pderiv{\vec{x}}{w}
  \]
\end{definition}
\begin{remark}[Note]
  Note that the scale factors and their corresponding unit vectors are all functions of $u, v, w$.
\end{remark}
\begin{definition}[Othogonal Curvilinear Coordinate System]
  An \textit{orthogonal curvilinear coordinate system} is one in which $\vec{e}_u, \vec{e}_v, \vec{e}_w$ are mutually orthogonal.
  We also typically reorder them so that $\{\vec{e}_v, \vec{e}_v, \vec{e}_w\}$ forms a right handed orthonormal set.
\end{definition}
This means we can use $\{\vec{e}_u, \vec{e}_v, \vec{e}_w\}$ as an orthonormal basis, but note that the basis is different at every $\vec{x}$ so it is only a \textit{local basis} about $\vec{x}$.

When we say that it forms a local basis, we mean that any vector field $\vec{F}(\vec{x})$ can be expressed \textbf{at} $\vec{x}$ in terms of its components relative to the basis vectors $\{\vec{e}_u, \vec{e}_v, \vec{e}_w\}$ \textbf{at} $\vec{x}$, that is:
\[
  \vec{F}(\vec{x}) = F_u \vec{e}_u + F_v \vec{e}_v + F_w \vec{e}_w
\]
Even if $\vec{F}$ is a constant vector, its components wont be as the basis could be different at every $\vec{x}$.
\begin{remark}
  It is preferable to write $\vec{F} = 2 \vec{e}_u + \vec{e}_w$ instead of $\vec{F} = (2, 0, 1)$ as it is clearer to see that $\vec{F}$ is \textbf{not} a constant position vector.
\end{remark}

We can extend \cref{infinitesimalTaylor} to the vector function $\vec{x}(u, v, w)$.
We then see that a small displacement $\d{\vec{x}}$ is given by:
\begin{align}
  \d{\vec{x}} &= \pderiv{\vec{x}}{u} \d{u} + \pderiv{\vec{x}}{v} \d{v} + \pderiv{\vec{x}}{w} \d{w} \nonumber \\
              &= h_u \d{u} \vec{e}_u + h_v \d{v} \vec{e}_v + h_w \d{w} \vec{e}_w \label{vectorInfinitesimal}
\end{align}
and not just $\d{u} \vec{e}_u + \d{v} \vec{e}_v + \d{w} \vec{e}_w$ as it would be if we were using Cartesian coordinates.

Similarly, the position vector is \textbf{not} given by $u\vec{e}_u + v\vec{e}_v + w\vec{e}_w$ as it would be in Cartesian.
There is a difference between the coordinates $(u, v, w)$, that are used to specify a point in this coordinate system, and the position vector $\vec{x}(u, v, w)$.
For example, we represent a point in plane polar coordinates as $(r, \theta)$ but this is not the same as the position vector $
\left(\begin{smallmatrix}
r \\
\theta \\
\end{smallmatrix}\right)$

\textbf{Constant Surfaces}\par
Consider a displacement that keeps $u$ fixed but allows $v$ and $w$ can vary.
Using \cref{vectorInfinitesimal} with $\d{u} = 0$:
\[
  \d{\vec{x}} = h_v \d{v} \vec{e}_v + h_w \d{w} \vec{e}_w
\]
Therefore, $\d{\vec{x}}$ is a linear combination of $\vec{e}_v$ and $\vec{e}_w$ only.
Since $\vec{e}_v$ and $\vec{e}_w$ are orthogonal to $\vec{e}_u$, as it is an orthonormal basis, $\d{\vec{x}} \perp \vec{e}_u$ for all possible $\d{\vec{x}}$.

As we have shown that any displacement that keeps $u$ fixed is orthogonal to $\vec{e}_u$, $\vec{e}_u$ is perpendicular to any surface of constant $u$ and similarly for $\vec{e}_v$ and $\vec{e}_w$.
So the three surfaces of constant $u$, constant $v$, and constant $w$ all intersect orthogonally at any given point as the basis vectors are always orthogonal at any point.
\section{Cylindrical Polar Coordinates}
\label{cylindricalPolar}
\begin{definition}
  Cylindrical polar coordinates are defined by:
  \[
    x = \rho \cos \phi,\ y = \rho \sin \phi,\ z = z
  \]
  where $\rho \geq 0$ and, although it is not necessary, $\phi$ is usually restricted to $[0, 2\pi)$.

  \begin{itemize}
    \item $\rho$ is called the \textit{radial distance} and is the distance from the $z$ axis to $\vec{x}$.
    \item $\phi$ is called the \textit{azimuth angle} and is the angle measured anticlockwise from the $x$-axis round to the $y$-axis of the projection of $\vec{x}$ onto the $x$-$y$ plane.
    \item $z$ is called the \textit{height} and is the signed distance from the $x$-$y$ plane to $\vec{x}$.
  \end{itemize}
  We write the components in the order $(\rho, \phi, z)$.
\end{definition}
\begin{remark}[Alternative Notation]
  Different notations are sometimes used.
  Sometimes people use $r$ instead of $\rho$ and/or $\theta$ instead of $\phi$.
\end{remark}
\begin{remark}
  If we restrict ourselves to $z = 0$ then we recover plane polar coordinates.
\end{remark}
\subsubsection{Visualisation}
\label{cylinderVisualisation}
The following diagram illustrates cylindrical coordinates and their infinitesimal components:
\begin{center}
  \input{../figures/CylindricalCoordinates}\par
  \footnotesize{Diagram from \url{https://tex.stackexchange.com/a/614355} -- Alexander Tsagkaropoulos}
\end{center}
\subsubsection{Inverting}
\label{invertingCylindrical}
Cylindrical polar coordinates can be inverted using:
\[
  \rho = \sqrt{x^2 + y^2},\ \tan \phi = \frac{y}{x},\ z = z
\]
$\rho$ and $z$ are easy to invert however some care needs to be taken with $\phi$ because of cases when $x = 0$.
You may also need to add or subtract $\pi$ from $\arctan(y/x)$.
It is advisable to draw a sketch in the $x$-$y$ to make this process simpler.
\subsubsection{Constant Surfaces}
\begin{itemize}
  \item Surfaces of constant $\rho$ are cylinders with the $z$-axis as their axis.
  \item Surfaces of constant $\phi$ are vertical planes through the $z$-axis orthogonal to the $x$-$y$ plane.
  \item Surfaces of constant $z$ are horizontal planes parallel to the $x$-$y$ plane.
\end{itemize}
Note that these three constant surfaces always meet orthogonally, as expected.
\subsubsection{Scale Factors and Basis Vectors}
\label{scaleBasisCylindrical}
We can find the scale factors and basis vectors using \cref{scaleFactors}:
\begin{align*}
  \vec{x}(\rho, \phi, z) = \begin{pmatrix}
  \rho \cos \phi \\
  \rho \sin \phi \\
  z \\
  \end{pmatrix} &\implies
  \pderiv{\vec{x}}{\rho} = \begin{pmatrix}
  \cos \phi \\
  \sin \phi \\
  0 \\
  \end{pmatrix},\
  \pderiv{\vec{x}}{\phi} = \begin{pmatrix}
  -\rho \sin \phi \\
  \rho \cos \phi \\
  0 \\
  \end{pmatrix},\ \pderiv{\vec{x}}{z} = \begin{pmatrix}
  0 \\
  0 \\
  1 \\
  \end{pmatrix} \\
  &\implies
  h_\rho = 1,\
  h_\phi = \rho,\
  h_z = 1\\
  &\ \text{ and }
  \vec{e}_\rho = \begin{pmatrix}
  \cos \phi \\
  \sin \phi \\
  0 \\
  \end{pmatrix},\
  \vec{e}_\phi = \begin{pmatrix}
  -\sin \phi \\
  \cos \phi \\
  0 \\
  \end{pmatrix},\
  \vec{e}_z = \begin{pmatrix}
  0 \\
  0 \\
  1 \\
  \end{pmatrix}
\end{align*}
It is easy to check that $\{\vec{e}_\rho, \vec{e}_\phi, \vec{e}_z\}$ is orthonormal and right handed.
Furthermore, we see that each of the basis vectors are orthogonal to their respective constant surfaces, as expected.

Using these basis vectors, we can write $\vec{x}$ as:
\[
  \vec{x}(\rho, \phi, z) = \rho \begin{pmatrix}
  \cos \phi \\
  \sin \phi \\
  0 \\
  \end{pmatrix} + z \begin{pmatrix}
  0 \\
  0 \\
  1 \\
  \end{pmatrix} = \rho \vec{e}_\rho + z\vec{e}_z
\]
Note that we do not need a $\phi \vec{e}_\phi$ as $\vec{e}_\rho$ already points outwards in the correct direction.
\subsubsection{Infinitesimals}
\label{cylindricalInfinitesimals}
Using \cref{vectorInfinitesimal}, we obtain:
\begin{align*}
  \d{\vec{x}} &= h_\rho \d{\rho} \vec{e}_\rho + h_\phi \d{\phi} \vec{e}_\phi + h_z \d{z} \vec{e}_z \\
              &= \d{\rho} \vec{e}_\rho + \rho \d{\phi} \vec{e}_\phi + \d{z}\vec{e}_z
\end{align*}
Note that we have factor of $\rho$ in the second term because for a small change in $\phi$ of $\delta \phi$, the distance moved in the direction of $\vec{e}_\phi$ is $\rho \delta \phi$ up to a first order approximation and so becomes exactly $\rho \d{\phi}$ in infinitesimals.
This can more clearly seen in the visualisation above.
\section{Spherical Polar Coordinates}
\label{sphericalPolar}
\begin{definition}
  \textit{Spherical polar coordinates} are defined by:
  \[
    x = r \sin \theta \cos \phi,\ y = r \sin \theta \sin \phi,\ z = r \cos \theta
  \]
  where $r \geq 0$, $\theta$ is \textbf{always} restricted to $[0, \pi]$ and $\phi$ \textbf{can} be restricted to $[0, 2\pi)$.

  \begin{itemize}
    \item $r$ is called the \textit{radial distance} and is the distance the origin to $\vec{x}$.
    \item $\theta$ is called the \textit{polar angle} and is the angle between the $z$-axis and $\vec{x}$ measured down from the $z$ axis towards the $x$-$y$ plane
    \item $\phi$ is called the \textit{azimuth angle} and is the angle measured anticlockwise from the $x$-axis round to the $y$-axis of the projection of $\vec{x}$ onto the $x$-$y$ plane.
  \end{itemize}
  We write the components in the order $(r, \theta, \phi)$
\end{definition}
\begin{remark}[Alternative Notation]
  \begin{itemize}
    \item Some people order the coordinates $(r, \phi, \theta)$ instead.
    \item Some people swap the definitions of $\theta$ and $\phi$.
    \item Some people replace $\theta \mapsto \frac{\pi}{2} - \theta$.
  \end{itemize}
  This can all be quite confusing so beware when consulting other sources.
\end{remark}
\begin{remark}
  When $\theta = \frac{\pi}{2}$, we recover plane polar coordinates.
\end{remark}
\subsubsection{Visualisation}
The following diagram illustrates spherical polar coordinates and their infinitesimal components:
\begin{center}
  \input{../figures/SphericalCoordinates}\par
  \footnotesize{Diagram from \url{https://tex.stackexchange.com/a/614355} -- Alexander Tsagkaropoulos}
\end{center}
\subsubsection{Inverting}
Spherical polar coordinates can be inverted using:
\[
  r = \sqrt{x^2 + y^2 + z^2},\ \tan \theta = \frac{\sqrt{x^2 + y^2}}{z},\ \tan \phi = \frac{y}{x}
\]
Similarly to $\phi$ in cylindrical coordinates (\cref{invertingCylindrical}), care needs to be taken when inverting $\theta$ and $\phi$.
\subsubsection{Constant Surfaces}
\begin{itemize}
  \item Surfaces of constant $r$ are spheres centered at the origin.
  \item Surface of constant $\theta$ are cones with the $z$-axis as their axis and their apex at the origin.
  \item Surfaces of constant $\phi$ are vertical planes through the $z$-axis orthogonal to the $x$-$y$ plane.
\end{itemize}
Note that these three constant surfaces always meet orthogonally, as expected.
\subsubsection{Scale Factors and Basis Vectors}
\label{scaleBasisSpherical}
We can find the scale factors and basis vectors using \cref{scaleFactors}:
\begin{align*}
  &\vec{x}(r, \theta, \phi) = \begin{pmatrix}
  r\sin \theta \cos \phi \\
  r\sin \theta \sin \phi \\
  r\cos \theta \\
  \end{pmatrix} \\
  &\implies
  \pderiv{\vec{x}}{r} = \begin{pmatrix}
  \sin \theta \cos \phi \\
  \sin \theta \sin \phi \\
  \cos \theta \\
  \end{pmatrix},\
  \pderiv{\vec{x}}{\theta} = \begin{pmatrix}
  r\cos \theta \cos \phi \\
  r\cos \theta \sin \phi \\
  -r\sin \theta \\
  \end{pmatrix},\ \pderiv{\vec{x}}{\phi} = \begin{pmatrix}
  -r \sin \theta \sin \phi \\
  r \sin \theta \cos \phi  \\
  0 \\
  \end{pmatrix} \\
  &\implies
  h_r = 1,\
  h_\theta = r,\
  h_\phi = r\sin\theta\\
  &\ \text{ and }
  \vec{e}_r = \begin{pmatrix}
  \sin \theta \cos \phi \\
  \sin \theta \sin \phi \\
  \cos \theta \\
  \end{pmatrix},\
  \vec{e}_\theta = \begin{pmatrix}
  \cos \theta \cos \phi \\
  \cos \theta \sin \phi \\
  -\sin \theta \\
  \end{pmatrix},\
  \vec{e}_\phi = \begin{pmatrix}
  -\sin \phi \\
  \cos \phi \\
  0 \\
  \end{pmatrix}
\end{align*}
Using these basis vectors, we can write $\vec{x}$ as:
\[
  \vec{x}(r, \theta, \phi) = r\begin{pmatrix}
  \sin \theta \cos \phi \\
  \sin \theta \sin \phi \\
  \cos \theta \\
  \end{pmatrix} = r \vec{e}_r
\]
Note that this matches the notation $\vec{e}_r = \frac{1}{r}\vec{r}$ that we used earlier in \cref{radialIndentities}.
\subsubsection{Infinitesimals}
Using \cref{vectorInfinitesimal}, we obtain:
\begin{align*}
  \d{\vec{x}} &= h_r \d{r} \vec{e}_r + h_\theta \d{\theta} \vec{e}_\rho + h_\phi \d{\phi} \vec{e}_\phi \\
              &= \d{r} \vec{e}_r + r \d{\theta} \vec{e}_\theta + r \sin \theta \d{\phi} \vec{e}_\phi
\end{align*}
Again, the geometric intuition behind this can be seen in the above visualisation.
\section{Vector Differential Operators in Curvilinear Systems}
\subsection{General Orthogonal Curvilinear Coordinate Systems}
\label{generalCurvilinearOperators}
If we have a function expressed using $u, v, w$ instead of $x, y, z$, then we would like to express $\nabla f$ in terms of $u, v, w$ as well.
Consider:
\[
  \nabla f \cdot \vec{e}_u = \pderiv{f}{x_i} \frac{1}{h_u} \pderiv{x_i}{u} = \frac{1}{h_u} \pderiv{f}{u}
\]
by the chain rule.
Since $\{\vec{e}_u, \vec{e}_v, \vec{e}_v\}$ form an orthonormal basis, this gives us the component of $\nabla f$ along $\vec{e}_u$, and similarly for the components along $\vec{e}_v$ and $\vec{e}_w$.
Combining these components, we have:
\[
  \nabla f = \frac{1}{h_u} \pderiv{f}{u} \vec{e}_u + \frac{1}{h_v} \pderiv{f}{v} \vec{e}_v + \frac{1}{h_w} \pderiv{f}{w} \vec{e}_w
\]
This is true for any function $f$ so we can rearrange the terms, enabling us to write it as an operator:
\[
  \nabla \equiv \frac{1}{h_u} \vec{e}_u \pderiv{}{u} + \frac{1}{h_v} \vec{e}_v \pderiv{}{v} + \frac{1}{h_w} \vec{e}_w \pderiv{}{w}
\]
Calculating the divergence, curl, and Laplacian of a vector field in these general coordinates is quite difficult.
It can be done using the chain rule, however, this is quite a long process.
It can however be done considerably more efficiently using the coordinate independent forms of div and curl that we will see later in the course.
\begin{remark}[Reference]
  You are not expected to memorise the following equations, however they are useful for reference and when deriving vector differential operators in different coordinate systems as we will do in \cref{cylindricalOperators} and \cref{sphericalOperators}.
  \begin{align*}
    \nabla \cdot \vec{F} &= \frac{1}{h_u h_v h_w} \left[\pderiv{}{u}(h_vh_wF_u) + \pderiv{}{v}(h_uh_wF_v) + \pderiv{}{w}(h_uh_vF_w)\right] \\
    \nabla \times \vec{F} &= \frac{1}{h_u h_v h_w} \begin{vmatrix}
    h_u \vec{e}_u & h_v \vec{e}_v & h_w \vec{e}_w \\
    \pderiv{}{u} & \pderiv{}{v} & \pderiv{}{w} \\
    h_uF_u & h_vF_v & h_wF_w \\
    \end{vmatrix} \\
      \nabla^2 f &= \frac{1}{h_u h_v h_w}\left[\pderiv{}{u}\left(\frac{h_v h_w}{h_u}\pderiv{f}{u}\right)+ \pderiv{}{v}\left(\frac{h_u h_w}{h_v}\pderiv{f}{v}\right) + \pderiv{}{w}\left(\frac{h_u h_v}{h_w} \pderiv{f}{w}\right)\right]
  \end{align*}
\end{remark}
\subsection{Cylindrical Polar Coordinates}
\label{cylindricalOperators}
For a scalar field $f(\rho, \phi, z)$ and vector field $\vec{F} = F_\rho \vec{e}_\rho + F_\phi \vec{e}_\phi + F_z \vec{e}_z$ where each of $F_\rho, F_\phi, F_z$ is a function of $\rho, \phi, z$, we have:
\begin{align*}
  \nabla f &= \pderiv{f}{\rho} \vec{e}_\rho + \frac{1}{\rho}\pderiv{f}{\phi} \vec{e}_\phi + \pderiv{f}{z} \vec{e}_z \\
  \nabla \cdot \vec{F} &= \frac{1}{\rho} \pderiv{}{\rho}(\rho F_\rho) + \frac{1}{\rho} \pderiv{F_\phi}{\phi} + \pderiv{F_z}{z} \\
  \nabla \times \vec{F} &= \left(\frac{1}{\rho} \pderiv{F_z}{\phi} - \pderiv{F_\phi}{z}\right)\vec{e}_\rho + \left(\pderiv{F_\rho}{z} - \pderiv{F_z}{\rho}\right)\vec{e}_\phi + \frac{1}{\rho}\left(\pderiv{}{\rho}(\rho F_\phi) - \pderiv{F_\rho}{\phi}\right) \vec{e}_z \\
  \nabla^2 f &= \pderiv[2]{f}{\rho} + \frac{1}{\rho} \pderiv{f}{\rho} + \frac{1}{\rho^2} \pderiv[2]{f}{\phi} + \pderiv[2]{f}{z}
\end{align*}
These are derived using the scale factors and basis vectors defined in \cref{scaleBasisCylindrical}.
\begin{remark}
  The results for plane polar coordinates in $\R^2$ can be obtained by ignoring $z$ throughout.
\end{remark}
\subsection{Spherical Polar Coordinates}
\label{sphericalOperators}
For $f(r, \theta, \phi)$ and $\vec{F} = F_r \vec{e}_r + F_\theta \vec{e}_\theta + F_\phi \vec{e}_\phi$, where each of $F_r, F_\theta, F_\phi$ is a function of $r, \theta, \phi$, we have:
\begin{align*}
  \nabla f &= \pderiv{f}{r} \vec{e}_r + \frac{1}{r} \pderiv{f}{\theta} \vec{e}_\theta + \frac{1}{r \sin \theta} \pderiv{f}{\phi} \vec{e}_\phi \\
  \nabla \cdot \vec{F} &= \frac{1}{r^2} \pderiv{}{r}(r^2 F_r) + \frac{1}{r \sin \theta} \pderiv{}{\theta}(F_\theta \sin \theta) + \frac{1}{r \sin \theta} \pderiv{F_\phi}{\phi} \\
  \nabla \times \vec{F} &= \frac{1}{r \sin \theta} \left(\pderiv{}{\theta}(F_\phi \sin \theta) - \pderiv{F_\theta}{\phi}\right)\vec{e}_r \\
                        &\ + \frac{1}{r}\left(\frac{1}{\sin \theta} \pderiv{F_r}{\phi} - \pderiv{}{r}(rF_\phi)\right) \vec{e}_\theta \\
                        &\ + \frac{1}{r}\left(\pderiv{}{r}(r F_\theta) - \pderiv{F_r}{\theta}\right) \vec{e}_\phi \\
  \nabla^2 f &= \pderiv[2]{f}{r} + \frac{2}{r} \pderiv{f}{r} + \frac{1}{r^2 \sin \theta} \pderiv{}{\theta}\left(\pderiv{f}{\theta} \sin \theta\right) + \frac{1}{r^2 \sin^2 \theta} \pderiv[2]{f}{\phi}
\end{align*}
These are derived using the scale factors and basis vectors defined in \cref{scaleBasisSpherical}.

\begin{remark}[Note]
  We have already seen the first two terms of $\nabla^2 f$ in spherical coordinates:
  \[
    \pderiv[2]{f}{r} + \frac{2}{r}\pderiv{f}{r}
  \]
  when looking at the laplacian of a radially symmetric $f(r)$ in \cref{laplacianSphericalSymmetry}.
\end{remark}
\subsection{Examples}
\begin{example}[Comparison between spherical and clylindrical coordinates]
  Let $f(\vec{x}) = |\vec{x}|^2$ and $F(\vec{x}) = \vec{x}$.
  We have already used Cartesians to show $\nabla f = 2\vec{x}$ (\cref{gradExample}) and $\nabla \cdot \vec{F} = 3$ (\cref{divExample}).

  \textbf{Using Cylindrical Polar Coordinates}\par
  In cylindrical polar coordinates (\cref{cylindricalPolar}), we have $\vec{x} = \rho \vec{e}_r + z \vec{e}_z$ so $f(\rho, \phi, z) = \rho^2 + z^2$, which makes sense looking at the diagram for cylindrical coordinates in \cref{cylindricalPolar}.
  Furthermore, $F_\rho = \rho, F_\phi = 0, F_z = z$.

  We then have:
  \begin{align*}
    \nabla f &= \pderiv{f}{\rho} \vec{e}_\rho + \frac{1}{\rho}\pderiv{f}{\phi} \vec{e}_\phi + \pderiv{f}{z} \vec{e}_z \\
             &= 2\rho \vec{e}_\rho + \frac{1}{\rho}(0)\vec{e}_\phi  + 2z \vec{e}_z \\
             &= 2\vec{x}
  \end{align*}
  and:
  \begin{align*}
    \nabla \cdot \vec{F} &= \frac{1}{\rho} \pderiv{}{\rho}(\rho F_\rho) + \frac{1}{\rho} \pderiv{F_\phi}{\phi} + \pderiv{F_z}{z} \\
                         &= \frac{1}{\rho}(2\rho) + \frac{1}{\rho}(0) + 1 = 2 + 1 = 3
  \end{align*}
  Unsurprisingly, using cylindrical coordinates did not make this any easier because there is no property of $|\vec{x}|^2$ or $\vec{x}$ that matches the symmetries of a cylinder.

  \textbf{Using Spherical Polar Coordinates}\par
  If we use spherical polar coordinates (\cref{sphericalPolar}) instead, then we have $\vec{x} = r\vec{e}_r$ so $f(r, \theta, \phi) = r^2$ and $F_r = r, F_\theta = F_\phi = 0$. We then have:
  \begin{align*}
    \nabla f &= \pderiv{f}{r} \vec{e}_r + \frac{1}{r} \pderiv{f}{\theta} \vec{e}_\theta + \frac{1}{r \sin \theta} \pderiv{f}{\phi} \vec{e}_\phi \\
             &= 2r \vec{e}_r + \frac{1}{r} (0) \vec{e}_\theta + \frac{1}{r\sin \theta} (0) \vec{e}_\phi \\
             &= 2r\vec{e}_r = 2\vec{x}
  \end{align*}
  and:
  \begin{align*}
    \nabla \cdot \vec{F} &= \frac{1}{r^2} \pderiv{}{r}(r^2 F_r) + \frac{1}{r \sin \theta} \pderiv{}{\theta}(F_\theta \sin \theta) + \frac{1}{r \sin \theta} \pderiv{F_\phi}{\phi} \\
                         &= \frac{1}{r^2} (3r^2) + \frac{1}{r \sin \theta}(0) + \frac{1}{r \sin \theta}(0) \\
                         &= 3
  \end{align*}
  Using spherical polar coordinates made this process easier because $|\vec{x}|^2$ and $\vec{x}$ have spherical symmetries.
\end{example}
\begin{example}[Gravitational Field]
  Consider the gravitational force field $\vec{F} = - (GMm/r^2)\vec{e}_r$ of a fixed mass $M$ at the origin acting on another mass $m$:
  \[
    \nabla \cdot \vec{F} = - \frac{1}{r^2} \pderiv{}{r}\left(r^2 \frac{GMm}{r^2}\right) = 0
  \]
  In general, the divergence of a spherical inverse square law is 0 as for $\vec{F} = \frac{k}{r^2} \vec{e}_r$, we have:
  \[
    \nabla \cdot \vec{F} = \frac{1}{r^2} \pderiv{}{r}(r^2 F_r) = \frac{1}{r^2} \pderiv{}{r}\left(r^2 \frac{k}{r^2}\right) = 0
  \]
\end{example}
\begin{example}
  In spherical polars, consider a vector field $\vec{F} = \alpha(\theta)\vec{e}_\theta$.
  We saw earlier that $\nabla$ is:
  \[
    \nabla \equiv \vec{e}_r \pderiv{}{r} + \frac{1}{r} \vec{e}_\theta \pderiv{}{\theta} + \frac{1}{\sin \theta}\vec{e}_\phi \pderiv{}{\phi}
  \]
  So to find the curl of $\vec{F}$:
  \begin{align*}
    \nabla \times \vec{F} &= \left(\vec{e}_r \pderiv{}{r} + \frac{1}{r} \vec{e}_\theta \pderiv{}{\theta} + \frac{1}{\sin \theta}\vec{e}_\phi \pderiv{}{\phi}\right) \times (\alpha(\theta) \vec{e}_\theta) \\
                          &= \vec{e}_r \times \alpha(\theta) \pderiv{\vec{e}_\theta}{r} + \frac{1}{r} \vec{e}_\theta \times \pderiv{}{\theta}(\alpha(\theta)\vec{e}_\theta) + \frac{1}{r \sin \theta} \vec{e}_\phi \times \alpha (\theta) \pderiv{\vec{e}_\theta}{\phi}
  \end{align*}
  Note that we are able to move partial derivatives ``through'' the cross product because they are scalar operators, similarly to how we move them through the dot product in \cref{scalarOperatorMove}.

  To proceed we need to compute the partial derivates of $\vec{e}_\theta$ with respect to $r$, $\theta$, and $\phi$:
  \begin{align*}
    \pderiv{\vec{e}_\theta}{r} &= \pderiv{}{r} \left[\begin{pmatrix}
    \cos \theta \cos \phi \\
    \cos \theta \sin \phi \\
    -\sin \theta \\
    \end{pmatrix}\right] = \vec{0}\\
    \pderiv{\vec{e}_\theta}{\theta} &= \pderiv{}{\theta} \left[\begin{pmatrix}
    \cos \theta \cos \phi \\
    \cos \theta \sin \phi \\
    -\sin \theta \\
    \end{pmatrix}\right] = \begin{pmatrix}
    -\sin \theta \cos \phi \\
    -\sin \theta \sin \phi \\
    -\cos \theta \\
    \end{pmatrix} = -\vec{e}_r \\
    \pderiv{\vec{e}_\theta}{\phi} &= \pderiv{}{\phi} \left[\begin{pmatrix}
    \cos \theta \cos \phi \\
    \cos \theta \sin \phi \\
    -\sin \theta \\
    \end{pmatrix}\right] = \begin{pmatrix}
    -\cos \theta \sin \phi \\
    \cos \theta \cos \phi \\
    0 \\
    \end{pmatrix} = \cos \theta \vec{e}_\phi
  \end{align*}
  Hence:
  \begin{align*}
    \nabla \times \vec{F} &= \vec{e}_r \times \alpha(\theta) (\vec{0}) + \frac{1}{r}\vec{e}_\theta \left(a'(\theta)\vec{e}_\theta + \alpha(\theta) \pderiv{\vec{e}_\theta}{\theta}\right) + \frac{1}{r \sin \theta} \vec{e}_\phi \times (\alpha(\theta) \cos \theta \vec{e}_\phi) \\
                          &= \frac{1}{r}\vec{e}_\theta \times (\alpha'(\theta) \vec{e}_\theta - \alpha(\theta)\vec{e}_r) \\
                          &= -\frac{1}{r} \alpha(r) \vec{e}_\theta \times \vec{e}_r \\
                          &= \frac{1}{r}\alpha(\theta)\vec{e}_\phi \text{ as $\{\vec{e}_r, \vec{e}_\theta, \vec{e}_\phi\}$ is a right handed orthonormal set}
  \end{align*}
  This agrees with the result from the using the formula in \cref{sphericalOperators} with $F_\theta = \alpha(\theta), F_r = F_\phi = 0$:
  \[
    \nabla \times \vec{F} = \frac{1}{r\sin \theta} \left(- \pderiv{\alpha(\theta)}{\phi}\right)\vec{e}_r + \frac{1}{r} \pderiv{}{r}(r \alpha(\theta))\vec{e}_\phi = \frac{\alpha(\theta)}{r}\vec{e}_\phi
  \]
  The result for a more general $\vec{F}$ can be derived similarly, however, it is significantly more involved.
\end{example}
\subsection{Examinable Content}
For the exams you need to know:
\begin{itemize}
  \item Scale factors for both spherical and cylindrical coordinates.
  \item $\nabla f$ in a general coordinate system (which you can then use to find it for a specific coordinate system using its scale factors).
  \item The first two terms of $\nabla^2 f$ in cylindrical coordinates, i.e. the radial terms (or be able to derive them quickly if $f$ is just a function of $\rho$).
  \item The first two terms of $\nabla^2 f$ in spherical coordinates, i.e. the radial terms (or be able to derive them quickly if $f$ is just a function of $r$).
\end{itemize}
If you are required to use any of the other operators in a different coordinate system, then the relevant formula will be given to you in the question.
\end{document}
